<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HashLab — Generator • Identifier • Passwords</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#6ee7b7;--accent2:#60a5fa;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial; margin:0; background:linear-gradient(180deg,#071024 0%, #07172b 80%); color:#e6eef6; -webkit-font-smoothing:antialiased}
    .container{max-width:1100px;margin:36px auto;padding:24px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{width:56px;height:56px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#021122}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted)}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
    .section-title{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .field{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
    label{font-size:13px;color:var(--muted)}
    textarea,input,select{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:8px;color:inherit;font-size:14px}
    textarea{min-height:90px;resize:vertical}
    .row{display:flex;gap:8px}
    button{background:linear-gradient(90deg,var(--accent),var(--accent2));border:none;padding:10px 12px;border-radius:10px;color:#021122;font-weight:600;cursor:pointer}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--accent);font-weight:600}
    .output{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;word-break:break-all;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}
    .small{font-size:13px;color:var(--muted)}
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    .chip{background:var(--glass);padding:6px 8px;border-radius:999px;border:1px solid rgba(255,255,255,0.02);font-size:13px}
    footer{margin-top:16px;color:var(--muted);font-size:13px;text-align:center}

    /* responsive */
    @media (max-width:940px){.grid{grid-template-columns:1fr}}

    /* helper */
    .flex-between{display:flex;justify-content:space-between;align-items:center}
    .muted{color:var(--muted)}
    .copy{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 8px;border-radius:8px;color:var(--accent)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">HL</div>
      <div>
        <h1>HashLab</h1>
        <p class="lead">Generate hashes, identify hash types, and create strong passwords — all in one page.</p>
      </div>
    </header>

    <div class="grid">
      <div>
        <div class="card">
          <div class="section-title"><strong>Hash Generator</strong><span class="small muted">Compute hashes (client-side)</span></div>

          <div class="field">
            <label for="inputText">Input text</label>
            <textarea id="inputText" placeholder="Type text, file content, or paste a string..."></textarea>
          </div>

          <div class="row" style="margin-bottom:12px">
            <div style="flex:1">
              <label for="algo">Algorithm</label>
              <select id="algo">
                <option>MD5</option>
                <option>SHA-1</option>
                <option selected>SHA-256</option>
                <option>SHA-384</option>
                <option>SHA-512</option>
                <option>HMAC-SHA256</option>
                <option>HMAC-SHA1</option>
              </select>
            </div>
            <div style="width:160px">
              <label for="encoding">Output encoding</label>
              <select id="encoding"><option>hex</option><option>base64</option></select>
            </div>
          </div>

          <div class="field" id="keyField" style="display:none">
            <label for="hmacKey">HMAC key (for HMAC algorithms)</label>
            <input id="hmacKey" placeholder="secret key" />
          </div>

          <div class="row" style="margin-bottom:12px">
            <button id="genBtn">Generate Hash</button>
            <button id="clearBtn" class="btn-ghost">Clear</button>
            <button id="copyHash" class="copy">Copy</button>
          </div>

          <div>
            <label>Result</label>
            <div id="hashOutput" class="output">—</div>
            <div class="small muted" style="margin-top:8px">Tip: Large inputs are processed in-browser. HMAC requires a key.</div>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="section-title"><strong>Hash Identifier (Finder)</strong><span class="small muted">Guess possible hash algorithms from a hash string</span></div>
          <div class="field">
            <label for="identifyInput">Hash string</label>
            <input id="identifyInput" placeholder="Paste a hash (hex/base64/encoded)" />
          </div>
          <div class="row" style="margin-bottom:12px">
            <button id="identifyBtn">Identify</button>
            <button id="clearId" class="btn-ghost">Clear</button>
          </div>
          <div>
            <label>Possible types</label>
            <div id="identifyOutput" class="output">—</div>
            <div class="small muted" style="margin-top:8px">Note: identification is heuristic — many algorithms share lengths. This tool suggests likely candidates.</div>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="section-title"><strong>Password Generator</strong><span class="small muted">Create secure passwords</span></div>

          <div class="row" style="margin-bottom:10px">
            <div style="flex:1">
              <label>Length</label>
              <input id="pwLen" type="number" min="4" max="256" value="16" />
            </div>
            <div style="flex:1">
              <label>Count</label>
              <input id="pwCount" type="number" min="1" max="24" value="3" />
            </div>
          </div>

          <div class="row" style="margin-bottom:12px">
            <label class="chip"><input type="checkbox" id="optLower" checked /> lowercase</label>
            <label class="chip"><input type="checkbox" id="optUpper" checked /> uppercase</label>
            <label class="chip"><input type="checkbox" id="optNumbers" checked /> numbers</label>
            <label class="chip"><input type="checkbox" id="optSymbols" /> symbols</label>
          </div>

          <div class="row" style="margin-bottom:12px">
            <button id="genPw">Generate Passwords</button>
            <button id="copyPw" class="copy">Copy All</button>
          </div>

          <div>
            <label>Passwords</label>
            <div id="pwOutput" class="output">—</div>
            <div class="small muted" style="margin-top:8px">Entropy estimate shown per password when available.</div>
          </div>
        </div>
      </div>

      <aside>
        <div class="card">
          <div class="section-title"><strong>Quick Tools</strong><span class="small muted">Utilities</span></div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button id="toUpper" class="btn-ghost">Uppercase Input</button>
            <button id="toLower" class="btn-ghost">Lowercase Input</button>
            <button id="hashFromFile" class="btn-ghost">Hash a File (select)</button>
            <button id="exampleBtn" class="btn-ghost">Load Example</button>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <div class="section-title"><strong>About</strong></div>
          <p class="small muted">This runs fully in your browser — nothing leaves your machine. Uses Web Crypto API for secure hashing where available and a built-in MD5 fallback. Identification is best-effort.</p>
        </div>
      </aside>
    </div>

    <footer>
      Built with ❤️ — open to customizations. Want an exported ZIP or extra algorithms (bcrypt/argon2)? I can add server-side helpers or include WASM libs.
    </footer>
  </div>

  <script>
  // Utility helpers
  const $ = id => document.getElementById(id);
  const toHex = buf => {
    const bytes = new Uint8Array(buf);
    return Array.from(bytes).map(b => b.toString(16).padStart(2,'0')).join('');
  }
  const toBase64 = buf => {
    const bytes = new Uint8Array(buf);
    let binary = '';
    for (let i=0;i<bytes.byteLength;i++) binary += String.fromCharCode(bytes[i]);
    return btoa(binary);
  }

  async function subtleHash(algo, data) {
    if (typeof crypto === 'undefined' || !crypto.subtle) throw new Error('Web Crypto not available');
    return await crypto.subtle.digest(algo, data);
  }

  function str2ab(str){
    const encoder = new TextEncoder();
    return encoder.encode(str);
  }

  // Compact MD5 implementation (public-domain style)
  // Source: compact adaptation of a common JS MD5 implementation
  function md5cycle(x, k) {
    let [a,b,c,d] = x;
    function ff(a,b,c,d,x,s,ac){ a+= (b & c) | (~b & d) + x + ac | 0; return ((a<<s)|(a>>>(32-s)))+b|0; }
    function gg(a,b,c,d,x,s,ac){ a+= (b & d) | (c & ~d) + x + ac | 0; return ((a<<s)|(a>>>(32-s)))+b|0; }
    function hh(a,b,c,d,x,s,ac){ a+= (b ^ c ^ d) + x + ac | 0; return ((a<<s)|(a>>>(32-s)))+b|0; }
    function ii(a,b,c,d,x,s,ac){ a+= (c ^ (b | ~d)) + x + ac | 0; return ((a<<s)|(a>>>(32-s)))+b|0; }
    a = ff(a,b,c,d,k[0],7,-680876936); d = ff(d,a,b,c,k[1],12,-389564586); c = ff(c,d,a,b,k[2],17,606105819); b = ff(b,c,d,a,k[3],22,-1044525330);
    a = ff(a,b,c,d,k[4],7,-176418897); d = ff(d,a,b,c,k[5],12,1200080426); c = ff(c,d,a,b,k[6],17,-1473231341); b = ff(b,c,d,a,k[7],22,-45705983);
    a = ff(a,b,c,d,k[8],7,1770035416); d = ff(d,a,b,c,k[9],12,-1958414417); c = ff(c,d,a,b,k[10],17,-42063); b = ff(b,c,d,a,k[11],22,-1990404162);
    a = ff(a,b,c,d,k[12],7,1804603682); d = ff(d,a,b,c,k[13],12,-40341101); c = ff(c,d,a,b,k[14],17,-1502002290); b = ff(b,c,d,a,k[15],22,1236535329);
    a = gg(a,b,c,d,k[1],5,-165796510); d = gg(d,a,b,c,k[6],9,-1069501632); c = gg(c,d,a,b,k[11],14,643717713); b = gg(b,c,d,a,k[0],20,-373897302);
    a = gg(a,b,c,d,k[5],5,-701558691); d = gg(d,a,b,c,k[10],9,38016083); c = gg(c,d,a,b,k[15],14,-660478335); b = gg(b,c,d,a,k[4],20,-405537848);
    a = gg(a,b,c,d,k[9],5,568446438); d = gg(d,a,b,c,k[14],9,-1019803690); c = gg(c,d,a,b,k[3],14,-187363961); b = gg(b,c,d,a,k[8],20,1163531501);
    a = gg(a,b,c,d,k[13],5,-1444681467); d = gg(d,a,b,c,k[2],9,-51403784); c = gg(c,d,a,b,k[7],14,1735328473); b = gg(b,c,d,a,k[12],20,-1926607734);
    a = hh(a,b,c,d,k[5],4,-378558); d = hh(d,a,b,c,k[8],11,-2022574463); c = hh(c,d,a,b,k[11],16,1839030562); b = hh(b,c,d,a,k[14],23,-35309556);
    a = hh(a,b,c,d,k[1],4,-1530992060); d = hh(d,a,b,c,k[4],11,1272893353); c = hh(c,d,a,b,k[7],16,-155497632); b = hh(b,c,d,a,k[10],23,-1094730640);
    a = hh(a,b,c,d,k[13],4,681279174); d = hh(d,a,b,c,k[0],11,-358537222); c = hh(c,d,a,b,k[3],16,-722521979); b = hh(b,c,d,a,k[6],23,76029189);
    a = hh(a,b,c,d,k[9],4,-640364487); d = hh(d,a,b,c,k[12],11,-421815835); c = hh(c,d,a,b,k[15],16,530742520); b = hh(b,c,d,a,k[2],23,-995338651);
    a = ii(a,b,c,d,k[0],6,-198630844); d = ii(d,a,b,c,k[7],10,1126891415); c = ii(c,d,a,b,k[14],15,-1416354905); b = ii(b,c,d,a,k[5],21,-57434055);
    a = ii(a,b,c,d,k[12],6,1700485571); d = ii(d,a,b,c,k[3],10,-1894986606); c = ii(c,d,a,b,k[10],15,-1051523); b = ii(b,c,d,a,k[1],21,-2054922799);
    a = ii(a,b,c,d,k[8],6,1873313359); d = ii(d,a,b,c,k[15],10,-30611744); c = ii(c,d,a,b,k[6],15,-1560198380); b = ii(b,c,d,a,k[13],21,1309151649);
    a = ii(a,b,c,d,k[4],6,-145523070); d = ii(d,a,b,c,k[11],10,-1120210379); c = ii(c,d,a,b,k[2],15,718787259); b = ii(b,c,d,a,k[9],21,-343485551);
    x[0]= (x[0]+a)|0; x[1]=(x[1]+b)|0; x[2]=(x[2]+c)|0; x[3]=(x[3]+d)|0;
  }
  function md5(s){
    let bytes = new TextEncoder().encode(s);
    const n = bytes.length;
    const tail = (n<<4) + 0x80;
    const tmp = new Uint8Array(((n + 8) >> 6 << 4) + 16);
    tmp.set(bytes);
    tmp[n] = 0x80;
    const bitLen = n * 8;
    const dv = new DataView(tmp.buffer);
    dv.setUint32(tmp.length - 8, bitLen & 0xffffffff, true);
    dv.setUint32(tmp.length - 4, Math.floor(bitLen/0x100000000), true);
    const words = new Uint32Array(tmp.buffer);
    const x = new Int32Array(4);
    x[0]=1732584193; x[1]=-271733879; x[2]=-1732584194; x[3]=271733878;
    for(let i=0;i<words.length;i+=16){
      const block = Array.from(words.slice(i,i+16));
      md5cycle(x, block);
    }
    // little-endian
    const out = new DataView(new ArrayBuffer(16));
    out.setInt32(0,x[0],true); out.setInt32(4,x[1],true); out.setInt32(8,x[2],true); out.setInt32(12,x[3],true);
    return Array.from(new Uint8Array(out.buffer)).map(b=>b.toString(16).padStart(2,'0')).join('');
  }

  // Event wiring
  const algoSelect = $('algo');
  const encodingSelect = $('encoding');

  algoSelect.addEventListener('change', ()=>{
    const v = algoSelect.value;
    $('keyField').style.display = v.startsWith('HMAC') ? 'block' : 'none';
  });

  $('genBtn').addEventListener('click', async ()=>{
    const text = $('inputText').value || '';
    const algo = algoSelect.value;
    const enc = encodingSelect.value;
    if (!text){ $('hashOutput').textContent = 'Input empty'; return; }
    try{
      let out;
      if (algo === 'MD5'){
        out = md5(text);
        if (enc === 'base64') out = btoa(hexToBin(out));
      } else if (algo.startsWith('HMAC')){
        const key = $('hmacKey').value || '';
        if (!key){ $('hashOutput').textContent = 'Provide key for HMAC'; return; }
        const algoName = algo.split('-')[1];
        const keyData = str2ab(key);
        const cryptoKey = await crypto.subtle.importKey('raw', keyData, {name:'HMAC', hash:{name:algoName}}, false, ['sign']);
        const sig = await crypto.subtle.sign('HMAC', cryptoKey, str2ab(text));
        out = enc === 'hex' ? toHex(sig) : toBase64(sig);
      } else {
        const algoName = algo.replace('-', ''); // SHA-256 -> SHA256? we will map
        const map = { 'SHA-1':'SHA-1','SHA-256':'SHA-256','SHA-384':'SHA-384','SHA-512':'SHA-512' };
        const hashBuf = await subtleHash(map[algo]||algo, str2ab(text));
        out = enc === 'hex' ? toHex(hashBuf) : toBase64(hashBuf);
      }
      $('hashOutput').textContent = out;
    }catch(e){
      $('hashOutput').textContent = 'Error: '+(e.message||e);
    }
  });

  $('clearBtn').addEventListener('click', ()=>{ $('inputText').value=''; $('hashOutput').textContent='—'; });
  $('copyHash').addEventListener('click', ()=>{ copyText($('hashOutput').textContent); });

  // Identify heuristics
  function hexOnly(s){ return /^[0-9a-fA-F]+$/.test(s); }
  function base64only(s){ return /^[A-Za-z0-9+/=]+$/.test(s); }
  $('identifyBtn').addEventListener('click', ()=>{
    const v = $('identifyInput').value.trim();
    if (!v){ $('identifyOutput').textContent='Input empty'; return; }
    let s=v;
    // strip common prefixes
    const out = [];
    if (s.startsWith('$2a$')||s.startsWith('$2b$')||s.startsWith('$2y$')) out.push('bcrypt');
    if (s.startsWith('$argon2')) out.push('argon2');
    if (s.startsWith('$pbkdf2')||s.startsWith('pbkdf2')) out.push('PBKDF2-style');
    if (s.includes(':') && s.split(':').length===2 && hexOnly(s.split(':')[1])) out.push('Possibly MAC:prefix:hex');
    const raw = s.replace(/^\$.*\$|\{|\}/g,'');
    // lengths
    const L = raw.length;
    if (hexOnly(raw)){
      if (L===32) out.push('MD5 / NTLM / MD4 (32 hex)');
      if (L===40) out.push('SHA-1 (40 hex)');
      if (L===64) out.push('SHA-256 (64 hex)');
      if (L===96) out.push('SHA-384 (96 hex)');
      if (L===128) out.push('SHA-512 (128 hex)');
    }
    if (base64only(raw)){
      // base64 lengths vary; guess
      const bytesLen = Math.round((raw.length*3)/4);
      if (bytesLen===16) out.push('MD5 (base64 of 16 bytes)');
      if (bytesLen===20) out.push('SHA-1 (base64 of 20 bytes)');
      if (bytesLen===32) out.push('SHA-256 (base64 of 32 bytes)');
      if (bytesLen===64) out.push('SHA-512 (base64 of 64 bytes)');
    }
    if (out.length===0) out.push('No confident match. Length: '+raw.length);
    $('identifyOutput').textContent = out.join('\n');
  });
  $('clearId').addEventListener('click', ()=>{ $('identifyInput').value=''; $('identifyOutput').textContent='—'; });

  // Password generator
  function rndChoice(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
  function generatePassword(len, opts){
    const sets = [];
    if (opts.lower) sets.push('abcdefghijklmnopqrstuvwxyz');
    if (opts.upper) sets.push('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
    if (opts.nums) sets.push('0123456789');
    if (opts.syms) sets.push('!@#$%^&*()-_=+[]{};:,.<>?/|~');
    if (sets.length===0) return '';
    let all = sets.join('');
    // ensure at least one from each selected set
    let pw = '';
    for (const s of sets) pw += rndChoice(s);
    for (let i=pw.length;i<len;i++) pw += rndChoice(all);
    // shuffle
    pw = pw.split('').sort(()=>Math.random()-0.5).join('');
    return pw;
  }
  function estimateEntropy(len, opts){
    let pool=0;
    if (opts.lower) pool+=26;
    if (opts.upper) pool+=26;
    if (opts.nums) pool+=10;
    if (opts.syms) pool+=32;
    if (pool===0) return 0;
    return (Math.log2(pool)*len).toFixed(1);
  }

  $('genPw').addEventListener('click', ()=>{
    const len = parseInt($('pwLen').value,10) || 12;
    const count = Math.min(24, parseInt($('pwCount').value,10) || 3);
    const opts = {lower:$('optLower').checked, upper:$('optUpper').checked, nums:$('optNumbers').checked, syms:$('optSymbols').checked};
    const lines = [];
    for (let i=0;i<count;i++){
      const p = generatePassword(len, opts);
      const e = estimateEntropy(len, opts);
      lines.push(p + '    (entropy: '+e+' bits)');
    }
    $('pwOutput').textContent = lines.join('\n');
  });
  $('copyPw').addEventListener('click', ()=>{ copyText($('pwOutput').textContent); });

  // Quick tools
  $('toUpper').addEventListener('click', ()=>{$('inputText').value = $('inputText').value.toUpperCase();});
  $('toLower').addEventListener('click', ()=>{$('inputText').value = $('inputText').value.toLowerCase();});
  $('exampleBtn').addEventListener('click', ()=>{ $('inputText').value = 'hello world'; $('identifyInput').value='dffd6021bb2bd5b0af676290809ec3a3'; });

  // File hashing
  $('hashFromFile').addEventListener('click', ()=>{
    const inp = document.createElement('input'); inp.type='file';
    inp.onchange = async e => {
      const file = e.target.files[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = async ev => {
        const arr = new Uint8Array(ev.target.result);
        // compute selected algorithm
        const algo = algoSelect.value;
        try{
          let out;
          if (algo==='MD5') out = md5Binary(arr);
          else if (algo.startsWith('HMAC')) {
            const key = $('hmacKey').value || '';
            if (!key) { $('hashOutput').textContent='Provide key for HMAC'; return; }
            const keyData = str2ab(key);
            const cryptoKey = await crypto.subtle.importKey('raw', keyData, {name:'HMAC', hash:{name:algo.split('-')[1]}}, false, ['sign']);
            const sig = await crypto.subtle.sign('HMAC', cryptoKey, arr);
            out = encodingSelect.value==='hex' ? toHex(sig) : toBase64(sig);
          } else {
            const map = { 'SHA-1':'SHA-1','SHA-256':'SHA-256','SHA-384':'SHA-384','SHA-512':'SHA-512' };
            const h = a
